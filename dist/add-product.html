<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Edit Product - Dashboard HTML Template</title>
    <script defer src="./bundle.js"></script>
    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" />
    <link rel="stylesheet" href="css/fontawesome.min.css" />
    <link rel="stylesheet" href="jquery-ui-datepicker/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/templatemo-style.css">
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    
</head>
  <body>
    <nav class="navbar navbar-expand-xl">
      <div class="container h-100">
        </a>
        <button
          class="navbar-toggler ml-auto mr-0"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <i class="fas fa-bars tm-nav-icon"></i>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mx-auto h-100">
            <li class="nav-item">
              </a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="products.html">
                <i class="fas fa-shopping-cart"></i> Clothes
              </a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
        </div>
      </div>
    </nav>
    
    <div class="container tm-mt-big tm-mb-big">
      <div class="row">
        <div class="col-xl-9 col-lg-10 col-md-12 col-sm-12 mx-auto">
          <div class="tm-bg-primary-dark tm-block tm-block-h-auto">
            <div class="row">
              <div class="col-12">
                <h2 class="tm-block-title d-inline-block">Add Clothes</h2>
              </div>
            </div>
            <div class="row tm-edit-product-row">
              <div class="col-xl-6 col-lg-6 col-md-12">
                <form id="addForm" class="tm-edit-product-form">
                  <div class="form-group mb-3">
                    <label for="clothesCategory">Clothes Category</label>
                    <select class="custom-select tm-select-accounts" id="clothes">
                      <option selected>Select Clothes Category</option>
                      <option value="Top">Top</option>
                      <option value="Bottom">Bottom</option>
                      <option value="FootWear">Foot wear</option>
                      <option value="All">All</option>
                    </select>
                  </div>
                  <div class="form-group mb-3">
                    <label for="weather">Weather Condition</label>
                    <select class="custom-select tm-select-accounts" id="weather" name="weather">
                      <option selected>Select weather condition</option>
                      <option value="Clear sky">Clear sky</option>
                      <option value="Few clouds">Few clouds</option>
                      <option value="Scattered clouds">Scattered clouds</option>
                      <option value="Broken clouds">Broken clouds</option>
                      <option value="Shower rain">Shower rain</option>
                      <option value="Rain">Rain</option>
                      <option value="Thunderstorm">Thunderstorm</option>
                    </select>
                  </div>
                  <div class="row">
                    <div class="form-group mb-3 col-xs-12 col-sm-6">
                      <label for="outfit">Outfit</label>
                      <select class="custom-select tm-select-accounts" id="outfit" name="outfit">
                        <option selected>Select Outfit</option>
                        <option value="SunnyComfort">SunnyComfort</option>
                        <option value="LightLayers">LightLayers</option>
                        <option value="CloudyWarmth">CloudyWarmth</option>
                        <option value="CloudyCover">CloudyCover</option>
                        <option value="LightRainGear">LightRainGear</option>
                        <option value="RainyProtection">RainyProtection</option>
                        <option value="ThunderstormSafety">ThunderstormSafety</option>
                      </select>
                    </div>
                    <div class="form-group mb-3 col-xs-12 col-sm-6">
                      <label for="stock">Units In Stock</label>
                      <input id="stock" type="number" class="form-control validate"/>
                    </div>
                  </div>
              
                </div>
                <div class="col-lg-6">
                  <!-- New description field here -->
              
                  <div class="form-group mb-3">
                    <label for="description">Description</label>
                    <textarea class="form-control" id="description" rows="3" maxlength="100"></textarea>
                  </div>   
                    </div>
                     </div>
                        <div class="col-12">
                      <button type="submit" class="btn btn-primary btn-block text-uppercase" id="addBtn" >Add Clothes Now</button>
                    </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script type = "module">

  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-analytics.js";
  import { getFirestore, collection, addDoc } from 'https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore.js';
     // TODO: Add SDKs for Firebase products that you want to use
     // https://firebase.google.com/docs/web/setup#available-libraries
     
     // Your web app's Firebase configuration
     // For Firebase JS SDK v7.20.0 and later, measurementId is optional
     const firebaseConfig = {
     apiKey: "AIzaSyCmnqjXlksqhtHumP8WyKcTMsJ_hY7ys2E",
     authDomain: "faheemfirebase-7e868.firebaseapp.com",
     projectId: "faheemfirebase-7e868",
     storageBucket: "faheemfirebase-7e868.appspot.com",
     messagingSenderId: "804165468060",
     appId: "1:804165468060:web:a6f9a3c79013605c9dd259",
     measurementId: "G-FEG0FPGY1W"
   };
 
 // Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db = getFirestore(app);
 
 //logout function 
 document.getElementById('addForm').addEventListener('submit', submitForm);

// Submit form
function submitForm(e){
  e.preventDefault();

  // Get values
  let clothes = getSelectValue('clothes');
  let weather = getSelectValue('weather');
  let outfit = getSelectValue('outfit');
  let stock = getInputValue('stock');
  let description = getInputValue('description');

    // Create the modal
    const modal = `
    <div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="confirmModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmModalLabel">Confirm Addition</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            Are you sure you want to add this product to the list?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-dismiss="modal">✖️Cancel</button>
            <button type="button" class="btn btn-success" id="confirmAdd">✔Confirm</button>
          </div>
        </div>
      </div>
    </div>
  `;
  
  // Add the modal to the page
  $("body").append(modal);

  // Show the modal
  $("#confirmModal").modal("show");

  // Handle the confirmation
  $("#confirmAdd").click(function() {
    // Save product
    saveProduct(clothes, weather, outfit, stock, description);
  });
// Close modal when the cancel button is clicked
$(".btn-danger").click(function() {
    // Hide the modal
    $("#confirmModal").modal('hide');
});

// Close modal when the exit button is clicked
$(".close").click(function() {
    // Hide the modal
    $("#confirmModal").modal('hide');
});
  // Clear form
  document.getElementById('addForm').reset();
}

// Function to get form value
function getInputValue(id){
  return document.getElementById(id).value;
}

// Function to get select value
function getSelectValue(id){
  return document.getElementById(id).options[document.getElementById(id).selectedIndex].value;
}

// Save product to firestore
async function saveProduct(clothes, weather, outfit, stock, description) {
  try {
    const docRef = await addDoc(collection(db, "clothes"), {
      clothes: clothes,
      weather: weather,
      outfit: outfit,
      stock: stock,
      description: description 
    });
    console.log("Document written with ID: ", docRef.id);
    // Display a success message
    swal({
      title: "Added Successfully!",
      text: "Product added to the list",
      icon: "success",
      button: "OK"
    });
    // Hide the modal
    $("#confirmModal").modal("hide");
    // Redirect to products.html after the sweetalert fires, delay for 2 seconds
    setTimeout(function(){
      window.location.href = 'products.html';
    }, 
    2000); // delay for 2 seconds
  } catch (error) {
    console.error("Error adding document: ", error);
  }
}
 </script>
<script>
  $(document).ready(function(){
      var $weather = $('#weather');
      var $outfit = $('#outfit');
  
      if ($weather.length && $outfit.length) {
          $weather.change(function(){
              var selectedWeather = $(this).children("option:selected").val();
              if(selectedWeather === 'Clear sky'){
                  $outfit.val('SunnyComfort'); // Selects "SunnyComfort"
              } else if(selectedWeather === 'Few clouds'){
                  $outfit.val('LightLayers'); // Selects "LightLayers"
              } else if(selectedWeather === 'Scattered clouds'){
                  $outfit.val('CloudyWarmth'); // Selects "CloudyWarmth"
              } else if(selectedWeather === 'Broken clouds'){
                  $outfit.val('CloudyCover'); // Selects "CloudyCover"
              } else if(selectedWeather === 'Shower rain'){
                  $outfit.val('LightRainGear'); // Selects "LightRainGear"
              } else if(selectedWeather === 'Rain'){
                  $outfit.val('RainyProtection'); // Selects "RainyProtection"
              } else if(selectedWeather === 'Thunderstorm'){
                  $outfit.val('ThunderstormSafety'); // Selects "ThunderstormSafety"
              }
          });
      } else {
          console.error('Element not found');
      }
  });
</script>

</body>
</html> 